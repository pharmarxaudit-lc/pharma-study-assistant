run = "sh -c 'cd frontend && rm -rf node_modules package-lock.json && npm install && npm run build && cd .. && python backend/app.py'"
entrypoint = "backend/app.py"
language = "python3"

[nix]
channel = "stable-24_11"

[deployment]
run = ["sh", "-c", "cd frontend && npm run build && cd .. && python backend/app.py"]
build = ["sh", "-c", "cd frontend && npm install && npm run build"]
deploymentTarget = "cloudrun"

[env]
PORT = "5000"
FLASK_ENV = "production"
NODE_ENV = "production"
